<div class="pet-show-container">
  <%# --- HERO SECTION (Outside the frame so it stays still) --- %>
  <div class="pet-hero-section">
    <%# Create the list for the carousel once %>
    <% all_pets = [@pet] + @other_pets.to_a %>
    <div class="splide" data-controller="carousel">
      <div class="splide__track">
        <ul class="splide__list">
          <% all_pets.each do |pet| %>
            <li class="splide__slide">
              <%= link_to user_pet_path(@user, pet), class: "avatar-wrapper" do %>
                <%= cl_image_tag pet.photo.key, crop: :fill, class: "avatar-img" if pet.photo.attached? %>
              <% end %>
            </li>
          <% end %>
        </ul>
      </div>
      <div class="splide__arrows">
        <button class="splide__arrow splide__arrow--prev custom-carousel-control prev" type="button"></button>
        <button class="splide__arrow splide__arrow--next custom-carousel-control next" type="button"></button>
      </div>
    </div>
  </div>
  <%# --- TURBO FRAME (Everything inside here swaps when you click an avatar) --- %>
  <%= turbo_frame_tag "pet_details" do %>
    <h1 class="mt-3 text-center"><%= @pet.name %></h1>
    <h2 class="details-title"><%= @pet.name %>’s Details</h2>
    <div class="vital-grid">
      <%# DOB %>
      <div class="vital-card">
        <i class="fa-solid fa-pencil edit-pencil"></i>
        <i class="fa-solid fa-calendar-days card-icon"></i>
        <span class="card-label">Date of Birth:</span>
        <span class="card-value"><%= @pet.dob.strftime("%Y/%m/%d") if @pet.dob %></span>
      </div>
      <%# Vaccines %>
      <div class="vital-card">
        <i class="fa-solid fa-pencil edit-pencil"></i>
        <i class="fa-solid fa-syringe card-icon"></i>
        <span class="card-label">Vaccines:</span>
        <span class="card-value"><%= @pet.vacc_status %></span>
      </div>
      <%# Microchip %>
      <div class="vital-card">
        <i class="fa-solid fa-pencil edit-pencil"></i>
        <i class="fa-solid fa-microchip card-icon"></i>
        <span class="card-label">Microchip:</span>
        <span class="card-value"><%= @pet.microchip.presence || "None" %></span>
      </div>
      <%# Weight %>
      <div class="vital-card">
        <i class="fa-solid fa-pencil edit-pencil"></i>
        <i class="fa-solid fa-weight-hanging card-icon"></i>
        <span class="card-label">Weight:</span>
        <span class="card-value"><%= @pet.weight %> kg</span>
      </div>
      <%# Medications %>
      <div class="vital-card">
        <i class="fa-solid fa-pencil edit-pencil"></i>
        <i class="fa-solid fa-capsules card-icon"></i>
        <span class="card-label">Medications:</span>
        <span class="card-value"><%= @pet.current_meds.presence || "None" %></span>
      </div>
      <%# Notes %>
      <div class="vital-card">
        <i class="fa-solid fa-pencil edit-pencil"></i>
        <i class="fa-solid fa-note-sticky card-icon"></i>
        <span class="card-label">Notes:</span>
        <span class="card-value"><%= @pet.notes.presence || "No notes yet" %></span>
      </div>
    </div>
    <div class="pet-actions-footer">
      <%= link_to user_pet_logs_path(@user, @pet), class: "btn-log", data: { turbo_frame: "_top" } do %>
        <i class="fa-solid fa-book-open"></i> View <%= @pet.name %>’s Logs
      <% end %>
      <%= link_to new_user_pet_log_path(@user, @pet), class: "btn-log", data: { turbo_frame: "_top" } do %>
        <i class="fa-solid fa-plus"></i> Add New Log
      <% end %>
    </div>
  <% end %>
</div>
